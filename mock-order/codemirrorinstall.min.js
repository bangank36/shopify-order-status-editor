(function($) {
    $(document).ready(function() {
        if ($('#editor').length > 0) {
            var editor = CodeMirror.fromTextArea(document.getElementById('editor'), {
                lineNumbers: !0,
                indentWithTabs: !0,
                tabSize: 2,
                foldGutter: !0,
                matchBrackets:true,
                theme: "lucario"
            });
            var result = document.getElementById('set_result');
            var button = document.getElementById('get_result');
            var loading = document.getElementById('loading');
            var engine = new liquidjs.Liquid();
            button.onclick = getResult;

            function getResult(e) {
                e.preventDefault();
                loading.style.display = "block";
                engine.parseAndRender(editor.getValue()).then(function(data) {
                    result.value = data.replace(/\s/g, '');
                    loading.style.display = "none";
                    result.style.display = "block"
                }).catch(function(err) {
                    result.value = "Error in liquid syntax! \nError: " + err;
                    loading.style.display = "none";
                    result.style.display = "block"
                })
                return !1
            }
            editor.on('change', function(cMirror) {
                result.style.display = "none"
            })
        }
    })
}(jQuery))
